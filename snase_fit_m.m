function f = snase_fit_m(x,k_ppoe1)

global Time
global k1 k2 k3 k4 k5 k6 k7 k8

m1=x(1); m2=x(2); m3=x(3); m4=x(4); 
m5=x(5); m6=x(6); m7=x(7); m8=x(8);

Data1=[                                                      %Refolding Data
0.34	2.2		0.39	4.8		0.55	0.17	0.07	
0.41	1.8	    0.38	3.6		0.57	0.15	0.07	
0.41	1.6	    0.28	3.4		0.7		0.14	0.07
0.45	1.3	    0.24	2.86	0.73	0.12	0.06	
0.49	1	    0.18	2.26	0.78	0.12	0.05	
0.52	0.8		0.16	2.07	0.82	0.08	0.05	
0.57	0.7		0.18	1.69	0.79	0.09	0.05	
0.64	0.28	0.12	1.17	0.9		0		0		
0.72	0.24	0.14	0.81	0.89	0		0			
0.8	    0.21	0.2	    0.57	0.83	0		0			
0.84	0.12	0.14	0.41	0.86	0		0			
0.88	0.12	0.16	0.37	0.87	0		0			
0.95	0.1		0.26	0.26	0.76	0		0			
1.03	0.08	0.36	0.19	0.66	0		0			
1.14	0.06	0.5		0.11	0.5		0		0		
1.26	0.05	1.03	0		0		0		0				
1.34	0.04	1.05	0		0		0		0										
1.37	0.04	1.05	0		0		0		0										
1.41	0.04	1.03	0		0		0		0										
1.49	0.05	1.02	0		0		0		0										
1.49	0.05	1.09	0		0		0		0										
1.6	    0.06	1.14	0		0		0		0	]; %columns: [Gdn] Rate1 Amp1 Rate2 Amp2 Rate3 Amp3		


Data2=[                                                      %Unfolding Data
7.3	    21.4
7.1	    20.09
7.07	19.4
6.91	18.47
6.71	16.81
6.52	15.44
6.52	15.53
6.32	13.83
6.32	14.09
6.13	12.78
5.93	11.47
5.74	10.54
5.54	9.38
5.35	8.37
5.15	7.63
4.96	6.6
4.76	5.92
4.76	5.91
4.57	5.03
4.57	5.12
4.37	4.32
4.18	3.53
4.02	3.08
3.98	2.89
3.79	2.36
3.79	2.26
3.79	2.25
3.58	1.79
3.54	1.66
3.37	1.3
3.28	1.17
3.16	0.93
2.95	0.64
2.74	0.44
2.74	0.44
2.53	0.3
2.53	0.29
2.32	0.2
2.11	0.12
1.89	0.07
1.68	0.04 ];


R=8.314;
Temp=273.15+20;

sizer=size(Data1);
for i=1:sizer(1)
    
    GdnConc=Data1(i,1);
    k1=k_ppoe1(1)*exp(m1*GdnConc/(R*Temp));
    k2=k_ppoe1(2)*exp(m2*GdnConc/(R*Temp));
    k3=k_ppoe1(3)*exp(m3*GdnConc/(R*Temp));
    k4=k_ppoe1(4)*exp(m4*GdnConc/(R*Temp));
    k5=k_ppoe1(5)*exp(m5*GdnConc/(R*Temp));
    k6=k_ppoe1(6)*exp(m6*GdnConc/(R*Temp));
    k7=k_ppoe1(7)*exp(m7*GdnConc/(R*Temp));
    k8=k_ppoe1(8)*exp(m8*GdnConc/(R*Temp));
    
    Q=[-k1   k2             0    0    0
    k1 -(k2+k3+k5+k7)  k4   k6   k8
    0       k3        -k4    0    0
    0          k5       0  -k6    0
    0             k7    0    0  -k8];  %PPOE1 model

    [V,D]=eig(Q);

    n0=[1 0 0 0 0]';

    m=V^-1*n0;
    for j=1:5
        A(j)=V(3,j)*m(j);
        lamda(j)=D(j,j);
    end

end

% 
% z=z';
% 
% a=[];b=[];
% for i=1:Data_size(1)
%     a=[a z(i,:)];
%     b=[b N_ex(i,:)];
% end

f=a-b;